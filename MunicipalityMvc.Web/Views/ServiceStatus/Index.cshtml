@model List<MunicipalityMvc.Core.Models.ServiceRequest>
@{
    ViewData["Title"] = "Service Request Status";
}

<div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
        <div>
            <h2 class="mb-1">Service Request Status</h2>
            <p class="text-muted mb-0">View and search service requests</p>
        </div>
    </div>

    <div class="mb-3 d-flex gap-2">
        <form asp-action="Search" method="get" class="d-flex gap-2">
            <input type="text" name="requestNumber" class="form-control" placeholder="Search by request number" style="max-width: 300px;" />
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
        <a asp-action="Priority" class="btn btn-warning">View Priority Queue</a>
    </div>
    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle table-sm">
            <thead>
                <tr>
                        <th>Request #</th>
                        <th>Title</th>
                        <th>Category</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <th>Assigned To</th>
                        <th>Location</th>
                        <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var request in Model)
                {
                    <tr>
                        <td><strong>@request.RequestNumber</strong></td>
                        <td>@request.Title</td>
                        <td><span class="badge text-bg-secondary">@request.Category</span></td>
                        <td>
                            @if (request.Priority == MunicipalityMvc.Core.Models.RequestPriority.High)
                            {
                                <span class="badge text-bg-danger">High</span>
                            }
                            else if (request.Priority == MunicipalityMvc.Core.Models.RequestPriority.Medium)
                            {
                                <span class="badge text-bg-warning">Medium</span>
                            }
                            else
                            {
                                <span class="badge text-bg-success">Low</span>
                            }
                        </td>
                        <td>
                            @if (request.Status == MunicipalityMvc.Core.Models.RequestStatus.New)
                            {
                                <span class="badge text-bg-info">New</span>
                            }
                            else if (request.Status == MunicipalityMvc.Core.Models.RequestStatus.InProgress)
                            {
                                <span class="badge text-bg-primary">In Progress</span>
                            }
                            else if (request.Status == MunicipalityMvc.Core.Models.RequestStatus.Assigned)
                            {
                                <span class="badge text-bg-warning">Assigned</span>
                            }
                            else if (request.Status == MunicipalityMvc.Core.Models.RequestStatus.Resolved)
                            {
                                <span class="badge text-bg-success">Resolved</span>
                            }
                            else
                            {
                                <span class="badge text-bg-dark">Closed</span>
                            }
                        </td>
                            <td>@(string.IsNullOrEmpty(request.AssignedTo) ? "Unassigned" : request.AssignedTo)</td>
                            <td>@request.Location</td>
                            <td>
                                <a asp-action="Dependencies" asp-route-id="@request.Id" class="btn btn-sm btn-outline-info">Dependencies</a>
                            </td>
                        </tr>
                }
            </tbody>
        </table>
    </div>

    <a asp-controller="Home" asp-action="Index" class="btn btn-link">Back to Main Menu</a>
</div>

